# FROM python:3
FROM ubuntu:18.04

# RUN apt-get update && apt-get install curl

RUN apt-get update -y && apt-get install python3-pip gconf-service libxext6 libxfixes3 \
    pkg-config libxi6 libxrandr2 libxrender1 libcairo2 libcups2 libdbus-1-3 \
    libexpat1 libfontconfig1 libgcc1 libgconf-2-4 libgdk-pixbuf2.0-0 libglib2.0-0 \
    libgtk-3-0 libnspr4 libpango-1.0-0 libpangocairo-1.0-0 libstdc++6 libx11-6 \
    libx11-xcb1 libxcb1 libxcomposite1 libxcursor1 libxdamage1 libxss1 libxtst6 \
    libappindicator1 libnss3 libasound2 libatk1.0-0 libc6 ca-certificates \
    fonts-liberation lsb-release xdg-utils python3-dev libevent-dev libzbar-dev \
    gcc libxml2-dev libxmlsec1-dev libxmlsec1-openssl xmlsec1 wget curl xvfb unzip -y 

# Install Chrome for Selenium
# RUN apt install -y chromium-browser

RUN curl https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb -o /chrome.deb
RUN dpkg -i /chrome.deb || apt-get install -yf
RUN rm /chrome.deb

# # RUN dpkg -i /chrome.deb || apt-get install -yf
# RUN curl https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb -o /chrome.deb
# RUN apt-get -f install

# RUN rm google-chrome-stable_current_amd64.deb

# Install chromedriver for Selenium

RUN curl https://chromedriver.storage.googleapis.com/2.31/chromedriver_linux64.zip -o /chromedriver.zip
RUN unzip /chromedriver.zip -d /usr/local/bin/chromedriver

# COPY chromedriver84 chromedriver84
# RUN ["chmod", "777", "chromedriver84"]
# RUN ls -l 
# RUN chmod -R 777 /usr/local/bin
RUN chmod 755 /usr/local/bin/chromedriver
# RUN ["chmod", "777", "/usr/local/bin/chromedriver"]
RUN ls -l /usr/local/bin
RUN python3 -m pip install --upgrade pip
RUN pip3 install selenium
RUN pip3 install pymongo
RUN pip3 install dnspython

ADD linkedin_scrape.py linkedin_scrape.py
CMD ["python3", "linkedin_scrape.py"]